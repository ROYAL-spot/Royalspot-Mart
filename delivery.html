<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RoyalSpot Mart - Delivery</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header>
    <img src="Images/RoyalMart.jpg" alt="RoyalSpot Logo" width="150" height="100" />
    <nav class="nav-menu">
      <a href="index.html">Home</a>
      <a href="Shop.html">Shop</a>
      <a href="contacts.html">Contact</a>
    </nav>
  </header>

  <main class="delivery-form-section">
    <h2>Delivery Information</h2>

    <form id="deliveryForm" action="send_delivery.php" method="POST">
      <label for="fullname">Full Name:</label>
      <input type="text" id="fullname" name="fullname" required>

      <label for="phone">Phone Number:</label>
      <input type="tel" id="phone" name="phone" required>

      <label for="email">Email Address:</label>
      <input type="email" id="email" name="email" required>

      <label for="address">Delivery Address:</label>
      <textarea id="address" name="address" rows="4" required></textarea>

      <label for="notes">Additional Notes (Optional):</label>
      <textarea id="notes" name="notes" rows="2"></textarea>

      <h3>Order Summary</h3>
      <ul id="orderSummary"></ul>
      <p id="totalCost">Total: R 0.00</p>

      <input type="hidden" id="orderData" name="order">

      <button type="submit">Place Order</button>
    </form>
  </main>

  <script>
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const summaryList = document.getElementById("orderSummary");
    const totalText = document.getElementById("totalCost");
    let total = 0;

    cart.forEach(item => {
      const li = document.createElement("li");
      li.textContent = `${item.name} - R ${item.price.toFixed(2)} x ${item.qty}`;
      summaryList.appendChild(li);
      total += item.price * item.qty;
    });

    totalText.textContent = "Total: R " + total.toFixed(2);

    // ✅ IMPORTANT ADDITION: Populate the hidden input with JSON string of cart data
    document.getElementById("orderData").value = JSON.stringify(cart);

    // Optional: Add a client-side check if cart is empty before submission
    document.getElementById("deliveryForm").addEventListener("submit", function(event) {
        if (cart.length === 0) {
            alert("Your cart is empty. Please add items before placing an order.");
            event.preventDefault(); // Stop form submission
        }
    });
  </script>

  <footer>
    <p>© 2025 RoyalSpot Mart. All Rights Reserved.</p>
    <div>
      <a href="#">Contact Us</a> |
      <a href="#">Terms & Conditions</a>
    </div>
  </footer>

</body>
</html>